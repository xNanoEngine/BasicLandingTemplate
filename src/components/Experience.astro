---
const experiences = [
  { date: "Actualidad", title: "Ingeniero Full Stack", company: "Freelance", description: "Desarrollo de apps con React y Astro.", icon: "üíª" },
  { date: "2024 - 1er sem", title: "Ayudante de C√°tedra", company: "Universidad Austral de Chile", description: "Sistemas Distribuidos y Programaci√≥n Cient√≠fica con Python.", icon: "üìö" },
  { date: "2024 - Verano", title: "Pr√°ctica Profesional", company: "Sophia Language", description: "Desarrollo web y consultas territoriales con procesamiento de lenguaje natural.", icon: "üöÄ" },
  { date: "2023 - 2do sem", title: "Ayudante de C√°tedra", company: "Universidad Austral de Chile", description: "Sistemas Operativos e Introducci√≥n a la Programaci√≥n.", icon: "üìö" },
  { date: "2019", title: "Estudiante Ingenier√≠a", company: "Universidad Austral de Chile", description: "Inicio de la carrera. Primeros proyectos acad√©micos.", icon: "üéì" },
];
---

<section id="experiencia" class="scroll-mt-24 w-full px-4 py-10 bg-white flex flex-col justify-center items-center min-h-screen">
    
    <div class="text-center mb-10 max-w-3xl mx-auto">
        <h2 class="text-4xl font-bold text-slate-800 mb-2">Mi Trayectoria</h2>
        <p class="text-slate-500 text-lg">El camino recorrido hasta hoy.</p>
    </div>

    <div class="max-w-7xl mx-auto w-full px-2">
        
        <!-- Vista m√≥vil -->
        <div class="md:hidden border-l-2 border-slate-200 ml-3 space-y-12">
            {experiences.map((exp, index) => (
                <div class={`relative pl-8 experience-item ${index > 2 ? 'hidden' : ''}`}>
                    
                    <div class="absolute top-0 -left-[25px] w-12 h-12 rounded-full bg-white border-4 border-blue-100 shadow-sm flex items-center justify-center z-10">
                        <span class="text-xl">{exp.icon}</span>
                    </div>

                    <article class="bg-white p-6 rounded-xl border border-slate-100 shadow-sm hover:shadow-lg transition-all duration-300">
                        <header class="mb-3">
                            <span class="inline-block py-1 px-3 rounded-full bg-blue-50 text-blue-600 text-xs font-bold tracking-wide uppercase mb-2">
                                {exp.date}
                            </span>
                            <h3 class="text-xl font-bold text-slate-800 leading-tight">
                                {exp.title}
                            </h3>
                            <div class="text-slate-500 text-sm font-medium mt-1 flex items-center gap-1">
                                <span>üè¢</span> {exp.company}
                            </div>
                        </header>
                        <p class="text-slate-600 leading-relaxed text-sm">
                            {exp.description}
                        </p>
                    </article>
                </div>
            ))}
        </div>

        <!-- Vista escritorio -->
        <div class="hidden md:block relative">
            <div class="flex gap-8 overflow-x-auto snap-x pt-20 pb-12 custom-scrollbar">
                {experiences.map((exp, index) => (
                    <div class="min-w-[350px] shrink-0 snap-center group relative">
                        
                        <!-- L√≠nea horizontal conectora -->
                        <div class={`absolute top-0 h-0.5 bg-slate-300 z-0
                            ${index === 0 ? 'left-1/2 right-0' : ''} 
                            ${index === experiences.length - 1 ? 'left-0 right-1/2' : ''}
                            ${index > 0 && index < experiences.length - 1 ? 'left-0 right-0' : ''}
                        `}></div>

                        <!-- C√≠rculo con icono -->
                        <div class="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-6 w-12 h-12 rounded-full bg-white border-4 border-white shadow-lg flex items-center justify-center z-10 group-hover:scale-110 group-hover:border-blue-500 transition-all duration-300">
                            <span class="text-xl">{exp.icon}</span>
                        </div>

                        <!-- Tarjeta -->
                        <article class="bg-slate-50 p-6 rounded-xl border border-slate-100 shadow-sm hover:shadow-lg transition-all duration-300 mt-8 text-center h-full flex flex-col">
                            
                            <!-- Flecha superior -->
                            <div class="absolute top-6 left-1/2 -translate-x-1/2 w-4 h-4 bg-slate-50 rotate-45 border-l border-t border-slate-100"></div>

                            <header class="mb-3">
                                <span class="inline-block py-1 px-3 rounded-full bg-blue-50 text-blue-600 text-xs font-bold tracking-wide uppercase mb-2">
                                    {exp.date}
                                </span>
                                <h3 class="text-xl font-bold text-slate-800 leading-tight">
                                    {exp.title}
                                </h3>
                                <div class="text-slate-500 text-sm font-medium mt-1 flex items-center justify-center gap-1">
                                    <span>üè¢</span> {exp.company}
                                </div>
                            </header>

                            <p class="text-slate-600 leading-relaxed text-sm grow">
                                {exp.description}
                            </p>
                        </article>
                    </div>
                ))}
            </div>
        </div>

    </div>

    {experiences.length > 3 && (
        <div class="mt-8 text-center md:hidden">
            <button id="show-more-btn" class="px-6 py-2 bg-white border border-slate-300 rounded-full text-slate-600 text-sm font-semibold shadow-sm hover:bg-slate-50 hover:border-blue-400 hover:text-blue-600 transition-all flex items-center gap-2 mx-auto">
                <span>Ver toda la trayectoria</span>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4 animate-bounce">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                </svg>
            </button>
        </div>
    )}

    <div class="hidden md:flex justify-center items-center gap-2 mt-4 text-slate-400 text-xs animate-pulse">
        <span>Desliza para ver m√°s</span> ‚Üí
    </div>

</section>

<script>
    const btn = document.getElementById('show-more-btn');
    btn?.addEventListener('click', () => {
        const hiddenItems = document.querySelectorAll('.experience-item.hidden');
        hiddenItems.forEach(item => {
            item.classList.remove('hidden');
            item.animate([
                { opacity: 0, transform: 'translateY(-10px)' },
                { opacity: 1, transform: 'translateY(0)' }
            ], { duration: 300, easing: 'ease-out' });
        });
        btn.style.display = 'none';
    });
</script>

<style>
    .custom-scrollbar::-webkit-scrollbar { height: 8px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 20px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background-color: #94a3b8; }
</style>